<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ã¿ã‚“ãªã®ã²ã¨ã‚Šæ™‚é–“ï½œé™ç©ã®é›¨ç²’</title>
  <style>
html, body {
  height: 100%;
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Hiragino Kaku Gothic ProN", Meiryo, "Noto Sans JP", sans-serif;
  color: #222;
  background: url("back.png") center/cover no-repeat fixed;
  overflow-x: hidden;
  overflow-y: auto;
}

/* èƒŒæ™¯ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.25);
  z-index: 0;
}

/* å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
main {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 6vh 4vmin;
  position: relative;
  z-index: 1;
}

/* ã²ã¨ã‚Šæ™‚é–“ã‚«ãƒ¼ãƒ‰ */
#randomSolo {
  background: rgba(255,255,255,0.65);
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  padding: 28px 32px;
  max-width: 600px;
  width: min(90vw, 600px);
  text-align: center;
  backdrop-filter: blur(6px);
  margin-bottom: 80px;
}
.label {
  font-size: .9rem;
  color: #f0f0f0;
  margin-bottom: 6px;
}
#soloTitle {
  font-weight: 700;
  font-size: 1.2rem;
  color: #fff;
  margin-bottom: 8px;
}
#soloOne {
  color: #f3f3f3;
  font-size: 1rem;
  line-height: 1.7;
  white-space: pre-wrap;
}

/* ğŸ° ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ï¼ˆä¸­å¤®ã«ç¸¦ä¸¦ã³ï¼‰ */
.button-column {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 70px;
  margin-bottom: 100px;
}

/* å„ã‚¢ã‚¤ã‚³ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ */
.icon-block {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}
.icon-label {
  color: #444;
  font-size: 1.1rem;
  font-weight: 500;
  margin-bottom: 12px;
  letter-spacing: 0.05em;
  text-shadow: 0 1px 3px rgba(255,255,255,0.6);
}

/* ä¸¸èƒŒæ™¯ */
.icon-wrapper {
  width: 160px;
  height: 160px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.7);
  box-shadow: 0 4px 16px rgba(0,0,0,0.25);
  backdrop-filter: blur(6px);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.icon-wrapper:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(0,0,0,0.35);
}

/* ğŸ° æ›´æ–°ãƒœã‚¿ãƒ³ */
#refreshButton {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
}
#refreshButton img {
  width: 60px;
  height: auto;
  opacity: 0.95;
  transition: transform 0.25s ease, opacity 0.25s ease;
}
#refreshButton:hover img {
  transform: scale(1.1);
  opacity: 1;
}

/* ğŸ”— ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ */
.share-icon {
  width: 75px;
  height: auto;
  opacity: 0.95;
  transition: transform 0.3s ease, opacity 0.3s ease;
}
.share-icon:hover {
  transform: scale(1.1);
  opacity: 1;
}
  </style>
</head>
<body>

<main>
  <!-- ğŸŒ§ ã‚«ãƒ¼ãƒ‰ -->
  <div id="randomSolo">
    <div class="label">ä»Šæ—¥ã®ã²ã¨ã‚Šæ™‚é–“</div>
    <div id="soloTitle">èª­ã¿è¾¼ã¿ä¸­...</div>
    <div id="soloOne"></div>
  </div>

  <!-- ğŸ° æ›´æ–°ï¼†ã‚·ã‚§ã‚¢ï¼ˆç¸¦ä¸¦ã³ä¸­å¤®é…ç½®ï¼‰ -->
  <div class="button-column">
    <!-- ã‚¬ãƒãƒ£ -->
    <div class="icon-block">
      <div class="icon-label">ã‚¬ãƒãƒ£ã‚’ã¾ã‚ã™</div>
      <div class="icon-wrapper">
        <button id="refreshButton" aria-label="æ›´æ–°">
          <img src="gacha.png" alt="æ›´æ–°">
        </button>
      </div>
    </div>

    <!-- ã‚·ã‚§ã‚¢ -->
    <div class="icon-block">
      <div class="icon-label">ã²ã¨ã‚Šæ™‚é–“ã‚’ã‚·ã‚§ã‚¢ã™ã‚‹</div>
      <div class="icon-wrapper">
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSc7G7paHmRJT79fj1Ayl0gf3hZrUFJ4Wi6mJEDpo5l9hvN-lQ/viewform?usp=dialog"
           target="_blank" rel="noopener noreferrer">
          <img src="share.png" alt="ã²ã¨ã‚Šæ™‚é–“ã‚’æŠ•ç¨¿ã™ã‚‹" class="share-icon">
        </a>
      </div>
    </div>
  </div>
</main>

<!-- âœ… XLSXãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
async function loadRandomSolo(){
  const XLSX_URL = 'solitude_time.xlsx';
  try {
    const res = await fetch(XLSX_URL, { cache: 'no-store' });
    if (!res.ok) throw new Error('XLSX fetch failed: ' + res.status);
    const ab = await res.arrayBuffer();
    const wb = XLSX.read(ab, { type: 'array' });
    const ws = wb.Sheets[wb.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(ws, { defval: '' });
    if (!rows.length) throw new Error('No rows found');

    const pick = rows[Math.floor(Math.random() * rows.length)];
    const title = pick['ã‚¿ã‚¤ãƒˆãƒ«'] || pick['title'] || '';
    const one   = pick['ã²ã¨ã“ã¨'] || pick['ä¸€è¨€'] || pick['comment'] || '';

    const formattedOne = one
      .replace(/[ã€‚ã€]/g, m => m + '<br>')
      .replace(/[\sã€€]+/g, '<br>')
      .replace(/<br><br>/g, '<br>');

    document.getElementById('soloTitle').textContent = title || 'ï¼ˆã‚¿ã‚¤ãƒˆãƒ«æœªè¨­å®šï¼‰';
    document.getElementById('soloOne').innerHTML = formattedOne || 'ï¼ˆã²ã¨ã“ã¨æœªè¨­å®šï¼‰';
  } catch (err) {
    console.error(err);
    document.getElementById('soloTitle').textContent = 'ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚';
    document.getElementById('soloOne').textContent = '';
  }
}
loadRandomSolo();
document.getElementById('refreshButton').addEventListener('click', loadRandomSolo);
</script>

</body>
</html>
