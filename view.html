<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ã¿ã‚“ãªã®ã²ã¨ã‚Šæ™‚é–“ï½œé™ç©ã®é›¨ç²’</title>
  <style>
html,body{
  height:100%;
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN",Meiryo,"Noto Sans JP",sans-serif;
  color:#222;
  display:flex;
  flex-direction: column;
  justify-content:center;
  align-items:center;
  background: url("back.png") center/cover no-repeat fixed;
  position: relative;
  overflow-x: hidden;
  overflow-y: auto;
}

/* ğŸŒ™ èƒŒæ™¯ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.25);
  z-index: 0;
}

/* ã‚«ãƒ¼ãƒ‰ */
#randomSolo {
  position: relative;
  z-index: 1;
  background: rgba(255,255,255,0.65);
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  padding: 28px 32px;
  max-width: 600px;
  width: min(90vw, 600px);
  text-align: center;
  transition: box-shadow .3s ease, transform .3s ease;
  backdrop-filter: blur(6px);
  margin-bottom: 40px; /* â† ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ã¨ã®é–“éš” */
}
#randomSolo:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 28px rgba(0,0,0,0.15);
}

/* ãƒ†ã‚­ã‚¹ãƒˆ */
.label {
  font-size: .9rem;
  color: #f0f0f0;
  margin-bottom: 6px;
}
#soloTitle {
  font-weight: 700;
  font-size: 1.2rem;
  color: #f8f8f8;
  margin-bottom: 8px;
}
#soloOne {
  color: #f3f3f3;
  font-size: 1rem;
  line-height: 1.7;
  margin-bottom: 16px;
  white-space: pre-wrap;
}

/* ğŸ° æ›´æ–°ãƒœã‚¿ãƒ³ */
#refreshButton {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  transition: transform 0.25s ease, opacity 0.25s ease;
}
#refreshButton img {
  width: 90px;
  height: auto;
  opacity: 0.9;
  user-select: none;
}
#refreshButton:hover img {
  transform: scale(1.06);
  opacity: 1;
}

/* ğŸ”— ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ï¼ˆä¸­å¤®é…ç½®ï¼‰ */
.share-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  z-index: 1;
  margin-bottom: 60px; /* ä½™ç™½ */
}
.share-icon {
  width: 120px;
  height: auto;
  opacity: 0.9;
  transition: transform 0.3s ease, opacity 0.3s ease;
  cursor: pointer;
  -webkit-user-drag: none;
}
.share-icon:hover {
  transform: translateY(-3px) scale(1.05);
  opacity: 1;
}
.share-label {
  margin-top: 0.4rem;
  font-size: 1rem;
  color: #f3f3f3;
  font-weight: 500;
  letter-spacing: 0.05em;
  user-select: none;
}
  </style>
</head>
<body>

  <!-- è¡¨ç¤ºã‚«ãƒ¼ãƒ‰ -->
  <div id="randomSolo">
    <div class="label"> ä»Šæ—¥ã®ã²ã¨ã‚Šæ™‚é–“</div>
    <div id="soloTitle">èª­ã¿è¾¼ã¿ä¸­...</div>
    <div id="soloOne"></div>
    <button id="refreshButton">
      <img src="gacha.png" alt="æ›´æ–°">
    </button>
  </div>

  <!-- ğŸ”— ã‚·ã‚§ã‚¢ã™ã‚‹ãƒœã‚¿ãƒ³ï¼ˆã‚«ãƒ¼ãƒ‰ç›´ä¸‹ä¸­å¤®ï¼‰ -->
  <div class="share-container">
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSc7G7paHmRJT79fj1Ayl0gf3hZrUFJ4Wi6mJEDpo5l9hvN-lQ/viewform?usp=dialog"
       target="_blank" rel="noopener noreferrer"
       aria-label="ã²ã¨ã‚Šæ™‚é–“ã‚’æŠ•ç¨¿ã™ã‚‹">
      <img src="share.png" alt="ã²ã¨ã‚Šæ™‚é–“ã‚’æŠ•ç¨¿ã™ã‚‹" class="share-icon">
    </a>
    <p class="share-label">ã‚·ã‚§ã‚¢ã™ã‚‹</p>
  </div>

  <!-- SheetJS (XLSX) CDN -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <script>
  async function loadRandomSolo(){
    const XLSX_URL = 'solitude_time.xlsx';
    try {
      const res = await fetch(XLSX_URL, { cache: 'no-store' });
      if (!res.ok) throw new Error('XLSX fetch failed: ' + res.status);
      const ab = await res.arrayBuffer();

      const wb = XLSX.read(ab, { type: 'array' });
      const ws = wb.Sheets[wb.SheetNames[0]];
      const rows = XLSX.utils.sheet_to_json(ws, { defval: '' });

      if (!rows.length) throw new Error('No rows found');

      const pick = rows[Math.floor(Math.random() * rows.length)];
      const title = pick['ã‚¿ã‚¤ãƒˆãƒ«'] || pick['title'] || '';
      const one   = pick['ã²ã¨ã“ã¨'] || pick['ä¸€è¨€'] || pick['comment'] || '';

      const formattedOne = one
        .replace(/ã€‚/g, 'ã€‚<br>')
        .replace(/[\sã€€]+/g, '<br>')
        .replace(/<br><br>/g, '<br>');

      document.getElementById('soloTitle').textContent = title || 'ï¼ˆã‚¿ã‚¤ãƒˆãƒ«æœªè¨­å®šï¼‰';
      document.getElementById('soloOne').innerHTML   = formattedOne || 'ï¼ˆã²ã¨ã“ã¨æœªè¨­å®šï¼‰';
    } catch (err) {
      console.error(err);
      document.getElementById('soloTitle').textContent = 'ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚';
      document.getElementById('soloOne').textContent   = '';
    }
  }

  loadRandomSolo();
  document.getElementById('refreshButton').addEventListener('click', loadRandomSolo);
  </script>
</body>
</html>
