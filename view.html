<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ã¿ã‚“ãªã®ã²ã¨ã‚Šæ™‚é–“ï½œé™ç©ã®é›¨ç²’</title>
  <style>
html, body {
  height: 100%;
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Hiragino Kaku Gothic ProN", Meiryo, "Noto Sans JP", sans-serif;
  color: #222;
  background: url("back.png") center/cover no-repeat fixed;
  position: relative;
  overflow-x: hidden;       /* æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç¦æ­¢ */
  overflow-y: auto;         /* ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è¨±å¯ */
  display: block;           /* flexã‚’è§£é™¤ */
  -webkit-overflow-scrolling: touch; /* iOSã§ãªã‚ã‚‰ã‹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
}

/* èƒŒæ™¯ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
body::before {
  content: "";
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.25);
  z-index: 0;
}

/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å…¨ä½“ï¼ˆä¸­å¤®å¯„ã›ï¼‹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰ */
main {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  padding: 8vh 4vmin 12vh;
  box-sizing: border-box;
  z-index: 1;
  position: relative;
}

/* ã‚«ãƒ¼ãƒ‰ */
#randomSolo {
  position: relative;
  z-index: 1;
  background: rgba(255,255,255,0.65);
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  padding: 28px 32px;
  max-width: 600px;
  width: min(90vw, 600px);
  text-align: center;
  transition: box-shadow .3s ease, transform .3s ease;
  backdrop-filter: blur(6px);
  margin-bottom: 80px;
}
#randomSolo:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 28px rgba(0,0,0,0.15);
}

/* ãƒ†ã‚­ã‚¹ãƒˆ */
.label {
  font-size: .9rem;
  color: #f0f0f0;
  margin-bottom: 6px;
}
#soloTitle {
  font-weight: 700;
  font-size: 1.2rem;
  color: #f8f8f8;
  margin-bottom: 8px;
}
#soloOne {
  color: #f3f3f3;
  font-size: 1rem;
  line-height: 1.7;
  margin-bottom: 16px;
  white-space: pre-wrap;
}

/* ğŸ° æ›´æ–°ï¼†ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³é…ç½®ã‚¨ãƒªã‚¢ */
.button-row {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  gap: 12vw; /* ä¸¸ã©ã†ã—ã®è·é›¢ */
  z-index: 2;
  margin-bottom: 60px;
}

/* å„ã‚¢ã‚¤ã‚³ãƒ³ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆãƒ©ãƒ™ãƒ«ï¼‹ä¸¸ï¼‰ */
.icon-block {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
}
.icon-label {
  color: rgba(255,255,255,0.9);
  font-size: 1rem;
  font-weight: 500;
  margin-bottom: 10px;
  letter-spacing: 0.03em;
  text-shadow: 0 1px 3px rgba(0,0,0,0.3);
}

/* ä¸¸ã„èƒŒæ™¯å…±é€š */
.icon-wrapper {
  position: relative;
  width: 150px;
  height: 150px;
  display: flex;
  justify-content: center;
  align-items: center;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.6);
  box-shadow: 0 4px 12px rgba(255,255,255,0.25);
  backdrop-filter: blur(6px);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.icon-wrapper:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 18px rgba(255,255,255,0.35);
}

/* ğŸ° æ›´æ–°ãƒœã‚¿ãƒ³ */
#refreshButton {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  width: 100%;
  height: 100%;
}
#refreshButton img {
  width: 55px;
  height: auto;
  opacity: 0.95;
  transition: transform 0.25s ease, opacity 0.25s ease;
  user-select: none;
}
#refreshButton:hover img {
  transform: scale(1.1);
  opacity: 1;
}

/* ğŸ”— ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ */
.share-icon {
  width: 70px;
  height: auto;
  opacity: 0.95;
  transition: transform 0.3s ease, opacity 0.3s ease;
  -webkit-user-drag: none;
}
.share-icon:hover {
  transform: scale(1.1);
  opacity: 1;
}

/* ğŸ“± ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼šæ¥µå°ç”»é¢ã®ã¿ç¸¦ä¸¦ã³ã«å¤‰æ›´ */
@media (max-width: 480px) {
  .button-row {
    flex-direction: column; /* 480pxä»¥ä¸‹ã®ç«¯æœ«ã®ã¿ç¸¦ä¸¦ã³ */
    gap: 36px; /* ãƒœã‚¿ãƒ³é–“éš”ã‚„ã‚„åºƒã‚ */
  }

  .icon-wrapper {
    width: 130px; /* ä¸¸ã‚’å°‘ã—å°ã•ãã—ã¦åã¾ã‚Šã‚’è‰¯ãã™ã‚‹ */
    height: 130px;
  }

  .icon-label {
    font-size: 0.9rem;
  }

  #refreshButton img {
    width: 50px;
  }

  .share-icon {
    width: 60px;
  }
}

  </style>
</head>
<body>

<main>
  <!-- è¡¨ç¤ºã‚«ãƒ¼ãƒ‰ -->
  <div id="randomSolo">
    <div class="label"> ä»Šæ—¥ã®ã²ã¨ã‚Šæ™‚é–“</div>
    <div id="soloTitle">èª­ã¿è¾¼ã¿ä¸­...</div>
    <div id="soloOne"></div>
  </div>

  <!-- ğŸ° æ›´æ–°ãƒœã‚¿ãƒ³ & ğŸ”— ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ -->
  <div class="button-row">
    <!-- å·¦ï¼šã‚¬ãƒãƒ£ -->
    <div class="icon-block">
      <div class="icon-label">ã‚‚ã†ä¸€åº¦ã‚¬ãƒãƒ£ã‚’ã¾ã‚ã™</div>
      <div class="icon-wrapper">
        <button id="refreshButton" aria-label="æ›´æ–°">
          <img src="gacha.png" alt="æ›´æ–°">
        </button>
      </div>
    </div>

    <!-- å³ï¼šã‚·ã‚§ã‚¢ -->
    <div class="icon-block">
      <div class="icon-label">ã²ã¨ã‚Šæ™‚é–“ã‚’ã‚·ã‚§ã‚¢ã™ã‚‹</div>
      <div class="icon-wrapper">
        <a href="https://docs.google.com/forms/d/e/1FAIpQLSc7G7paHmRJT79fj1Ayl0gf3hZrUFJ4Wi6mJEDpo5l9hvN-lQ/viewform?usp=dialog"
           target="_blank" rel="noopener noreferrer"
           aria-label="ã²ã¨ã‚Šæ™‚é–“ã‚’æŠ•ç¨¿ã™ã‚‹">
          <img src="share.png" alt="ã²ã¨ã‚Šæ™‚é–“ã‚’æŠ•ç¨¿ã™ã‚‹" class="share-icon">
        </a>
      </div>
    </div>
  </div>
</main>

<!-- SheetJS (XLSX) CDN -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<script>
async function loadRandomSolo(){
  const XLSX_URL = 'solitude_time.xlsx';
  try {
    const res = await fetch(XLSX_URL, { cache: 'no-store' });
    if (!res.ok) throw new Error('XLSX fetch failed: ' + res.status);
    const ab = await res.arrayBuffer();

    const wb = XLSX.read(ab, { type: 'array' });
    const ws = wb.Sheets[wb.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(ws, { defval: '' });

    if (!rows.length) throw new Error('No rows found');

    const pick = rows[Math.floor(Math.random() * rows.length)];
    const title = pick['ã‚¿ã‚¤ãƒˆãƒ«'] || pick['title'] || '';
    const one   = pick['ã²ã¨ã“ã¨'] || pick['ä¸€è¨€'] || pick['comment'] || '';

    const formattedOne = one
      .replace(/ã€‚/g, 'ã€‚<br>')
      .replace(/[\sã€€]+/g, '<br>')
      .replace(/<br><br>/g, '<br>');

    document.getElementById('soloTitle').textContent =
      title || 'ï¼ˆã‚¿ã‚¤ãƒˆãƒ«æœªè¨­å®šï¼‰';
    document.getElementById('soloOne').innerHTML =
      formattedOne || 'ï¼ˆã²ã¨ã“ã¨æœªè¨­å®šï¼‰';
  } catch (err) {
    console.error(err);
    document.getElementById('soloTitle').textContent =
      'ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚';
    document.getElementById('soloOne').textContent = '';
  }
}

loadRandomSolo();
document.getElementById('refreshButton')
        .addEventListener('click', loadRandomSolo);
</script>
</body>
</html>


